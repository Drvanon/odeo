<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular.js"></script>
<script src="//code.angularjs.org/1.2.3/angular-sanitize.js"></script>
<script>
var app = angular.module("app", ['ngSanitize']);

app.controller('BlogCtrl', function ($scope, $http) {
  $http.get('/static/data.json')
    .success(function (data) {
      $scope.blogs = data.blogs;
    })
    .error(function () {
      $scope.error = 'Something went wrong';
    });
});

app.filter('unsafe', function($sce) {
    return function(val) {
        return $sce.trustAsHtml(val);
    };
});

app.controller('TitleCtrl', function($scope, $http, $sce) {
  var url = "/blogs/titles";

  $scope.html = "<h1>Hello World</h1>";

  $http.get(url)
    .success(function(data) {
      $scope.titles = data.titles;
    })
    .error(function(data) {$scope.error = "Something went wrong";});
});
</script>

<!-- Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-40801514-1', 'onderzoekdeoorsprong.nl');
              ga('send', 'pageview');

</script>
<script src="/static/lightbox/js/lightbox-2.6.min.js"></script>
<link href="/static/lightbox/css/lightbox.css" rel="stylesheet" />

{% block scripts %}
{% endblock %}

<script src="/static/less.min.js"></script>
</head>
<body ng-app="app">

<div id='reageer'>
  <a href='/reacties'>
    <div id='reageer-wrapper'>
      <p id='reageer-text'>Reageer</p>
    </div>
  </a>
</div>

<div id="container">

  <div id="header">
    <header>
      <a href="/"><h1>OdeO</h1></a>
      <div id=sur_title>
        <h2>onderzoek</h2>
        <h2>de</h2>
        <h2>oorsprong</h2>
      </div>
    </header>
  </div>

  <div id="main">
    <div class="sidecontainer">
      <nav>
        <ul>
          <li><a href='/'><span>Home</span></a></li>
          <li><a href='/about'><span>About</span></a></li>
          <li><a href='http://www.pinterest.com/dorstijn/boards/'><span>Pinterest</span></a></li>
          <li><a href="http://fold.it/"><span>Foldit<span></a></li>
          <li><a href='/reacties'><span>Reageren</span></a></li>
        </ul>
      </nav>
    </div>
    {% raw %}
    <div id="blogs" ng-controller='BlogCtrl'>
      <p ng-if="error" class="error">{{ error }}</p>
      <div class="blog" ng-repeat="blog in blogs">
        <a href='/blog/{{ blog.id }}'><h2>{{ blog.title }}</h2></a>

        <div class="blog-content">

          <!-- p -->
          <p ng-repeat-start="el in blog.content" class="{{ el.class }}" id="{{ el.id }}" ng-if="el.type == 'p'">{{ el.text }}</p>

          <!-- img -->
          <a data-lightbox="image-1" href='{{ el.source }}' ng-if='el.type == "img"'>
            <img style="width: {{ el.width }}; float: {{ el.float }}" 
              class="{{ el.class }}" id="{{ el.id }}" ng-src="{{ el.source }}">
          </a>

          <!-- lead -->
          <div ng-if='el.type == "lead"' class="strong-container">
            <strong class="lead" ><p>{{ el.text }}</p></strong>
          </div>

          <!-- html -->
          <div ng-if="el.type == 'html'"  ng-bind-html="el.html | unsafe"></div>

          <!-- source --> 
          <div class="sources" ng-if='el.type == "sources"' ng-repeat-end="">
            <p ng-repeat="source in el.sources"><sup>{{ index }}</sup>
              <a href="{{ source.href }}">{{ source.text }}</a></p>
          </div>

        </div>
      </div>
    </div>

    <div class="sidecontainer">
      <aside id="interest" ng-controller="TitleCtrl">
        <h2>Archief:</h2>
        <p ng-if="error">{{ error }}</p>
        <ol>
          <li ng-repeat="title in titles">
            <a href="/blog/{{ title.id }}">{{ title.title }}</a>
          </li>
        </ol>
    </div>

  </div>
  {% endraw %}
</div>
</body>
</html>
